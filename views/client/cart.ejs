<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Giỏ hàng</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Merriweather|Roboto+Slab" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dancing+Script" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Satisfy" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
          integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
</head>
<body>
<nav class="navbar navbar-expand-lg bg-light sticky-top">
    <a class="logo" href="/home">
        <img src="http://primefitnessgyms.com/wp-content/uploads/2018/03/Prime-Fitnessold.png" class="" alt="">
    </a>
    <div class="collapse navbar-collapse my-nav">
        <ul class="navbar-nav">
            <li class="nav-item ">
                <a class="nav-link" href="/home">TRANG CHỦ</a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle " href="#" id="navbarDropdown1" role="button"
                   data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    DỊCH VỤ
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/group-ex">THỂ DỤC NHÓM</a>
                    <a class="dropdown-item" href="/fitness">THỂ HÌNH</a>
                    <a class="dropdown-item" href="/swim">BƠI LỘI</a>
                    <a class="dropdown-item" href="/yoga">YOGA</a>
                    <a class="dropdown-item" href="/kick-fit">KICKFIT & MMA</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle " href="#" id="navbarDropdown2" role="button"
                   data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    HỘI VIÊN
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/membership">QUYỀN LỢI HỘI VIÊN</a>
                    <a class="dropdown-item" href="/gallery">CÂU CHUYÊN THÀNH CÔNG</a>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="/coach">HUẤN LUYỆN VIÊN</a>
            </li>
            <!--<li class="nav-item">-->
            <!--<a class="nav-link active-page" href="/package">GÓI TẬP</a>-->
            <!--</li>-->
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle " href="/package" id="navbarDropdown2" role="button"
                   data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    GÓI TẬP
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/package/group-ex">THỂ DỤC NHÓM</a>
                    <a class="dropdown-item" href="/package/fitness">THỂ HÌNH</a>
                    <a class="dropdown-item" href="/package/swim">BƠI LỘI</a>
                    <a class="dropdown-item" href="/package/yoga">YOGA</a>
                    <a class="dropdown-item" href="/package/kick-fit">KICKFIT & MMA</a>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/news">TIN TỨC</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="/about-us">VỀ CHÚNG TÔI</a>
            </li>
            <li class="nav-item btn-try">
                <button class="btn btn-outline-danger " type="button" data-toggle="modal"
                        data-target="#register-modal">
                    ĐĂNG KÝ TẬP THỬ
                </button>
            </li>
        </ul>
    </div>
</nav>
<div class="modal fade" id="register-modal" tabindex="-1" role="dialog" aria-labelledby="registerModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="box-brand pl-5">
                    <div><img src="http://primefitnessgyms.com/wp-content/uploads/2018/03/Prime-Fitnessold.png"
                              alt="Brand">
                    </div>
                    <div class="banner">
                        Fit For Life
                    </div>
                </div>
                <button type="button" id="register-btn-show-modal" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="container-fluid">
                <div class="error">
                    <div id="summary"></div>
                    <form action="register/send" method="post" name="register-form" id="register-form">
                        <div class="form-group mt-4">
                            <input class="form-control" type="text" name="name" placeholder="Họ và tên">
                        </div>
                        <div class="form-group mt-4">
                            <input class="form-control" type="text" name="phone" placeholder="Số điện thoại">
                        </div>
                        <div class="form-group mt-4">
                            <input class="form-control" type="text" name="email" placeholder="Email">
                        </div>
                        <div class="form-group mt-4">
                            <textarea class="form-control" name="address" cols="30" rows="5"
                                      placeholder="Địa chỉ"></textarea>
                        </div>
                        <div class="form-group mt-4">
                            <select class="form-control" name="service">
                                <option value="Nhập dịch vụ ban muốn tư vấn">Nhập dịch vụ ban muốn tư vấn</option>
                                <option value="Fitness">Fitness</option>
                                <option value="Thể dục nhóm">Thể dục nhóm</option>
                                <option value="Bơi lội">Bơi lội</option>
                                <option value="Yoga">Yoga</option>
                                <option value="Kitfit & MMA">Kitfit & MMA</option>
                            </select>
                        </div>
                        <div class="form-group btn-register-now">
                            <button type="submit" class="btn btn-danger" id="btn-submit"
                                    name="btn-submit"
                                    value="Submit">ĐĂNG KÝ NGAY
                            </button>
                        </div>
                        <div class="text-white font-weight-bold mt-4">* Chúng tôi sẽ liên hệ với bạn trong vòng 24h
                        </div>
                        <div class="text-white font-weight-bold mb-4">* Vui lòng đọc kỹ điều kiện sử dụng</div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="page-content ">
    <section>
        <img width="100%"
             src=""
             alt="">
    </section>
    <section class=" register-now">
        <div class="row">
            <div class="col-8 ">
                <div class="text-white register-now-title">ĐĂNG KÝ NGAY</div>
                <div class="text-white register-now-detail">
                    Trải nghiệm 3 ngày miễn phí toàn bộ dịch vụ
                </div>
            </div>
            <div class="col-4 btn-register-now">
                <button class="btn btn-danger " type="button" data-toggle="modal"
                        data-target="#register-modal">
                    <div>ĐĂNG KÝ NGAY</div>
                </button>
            </div>
        </div>
    </section>
    <section class="bg-light">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div>
                        <h3 class="text-center pt-5 pb-3 font-weight-bold text-danger">GIỎ HÀNG</h3>
                    </div>
                    <div class="pb-5">
                        <table class="table table-bordered cart-table">
                            <thead>
                            <tr class="btn-secondary text-center">
                                <td>Ảnh</td>
                                <td>Tên</td>
                                <td>Giá</td>
                                <td>Số Lượng</td>
                                <td>Tổng</td>
                                <td>Xóa</td>
                            </tr>
                            </thead>
                            <tbody id="list-cart">
                            </tbody>
                            <tbody class="border-top-0">
                            <tr>
                                <td colspan="6">
                                    <div class="text-center">
                                        <button class="btn btn-danger">Cập nhật</button>
                                        <button class="btn btn-danger" type="submit" id="btn-pay">Thanh toán</button>
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class=" register-now">
        <div class="row">
            <div class="col-8 ">
                <div class="text-white register-now-title">ĐĂNG KÝ NGAY</div>
                <div class="text-white register-now-detail">
                    Trải nghiệm 3 ngày miễn phí toàn bộ dịch vụ
                </div>
            </div>
            <div class="col-4 btn-register-now">
                <button class="btn btn-danger " type="button" data-toggle="modal"
                        data-target="#register-modal">
                    <div>ĐĂNG KÝ NGAY</div>
                </button>
            </div>
        </div>
    </section>
</div>
<footer class=" bg-dark">
    <div class="row">
        <div class="col-3 box-brand-bug">
            <div class="box-bug">
                <h3>Liên kết</h3>
                <ul>
                    <li><a href="#">Tuyển dụng</a></li>
                    <li><a href="#">Góp ý - Phản hồi</a></li>
                    <li><a href="#">Điều kiện sử dụng</a></li>
                    <li><a href="#">Chính sách bảo mật</a></li>
                </ul>
            </div>
        </div>
        <div class="box-service col-3">
            <h3>Dịch vụ</h3>
            <ul>
                <li><a href="group-ex.ejs">Thể dục nhóm</a></li>
                <li><a href="fitness.ejs">Thể hình</a></li>
                <li><a href="swim.ejs">Bơi lội</a></li>
                <li><a href="yoga.ejs">Yoga</a></li>
                <li><a href="kick-fit.ejs">Kickfit & MMA</a></li>
            </ul>
        </div>
        <div class="box-Contact col-3">
            <h3>HOTLINE</h3>
            <div class="number"><a href="#">0793245698</a></div>
            <div class="row pl-3">
                <a class="" href="https://www.facebook.com/nam.n.noi.3">
                    <i class="fab fa-facebook-square fa-3x mr-2"></i>
                </a>
                <a class="" href="https://twitter.com/">
                    <i class=" fab fa-twitter-square fa-3x mr-2 "></i>
                </a>
                <a class="" href="https://www.instagram.com/__phnam__/">
                    <i class="fab fa-instagram fa-3x mr-2"></i>
                </a>
            </div>
        </div>
        <div class="box-brand col-3 pr-5">
            <div><img src="http://primefitnessgyms.com/wp-content/uploads/2018/03/Prime-Fitnessold.png" alt="Brand">
            </div>
            <div class="banner">
                Fit For Life
            </div>
        </div>
    </div>
</footer>
<script src="/library/jquery-3.3.1.min.js"></script>
<script src="/library/bootstrap.min.js"></script>
<script>
    if (localStorage.getItem('listAdded') != null) {
        var listAddedString = localStorage.getItem('listAdded');
        var listAdded = JSON.parse(listAddedString);
        var htmlContent = '';
        var all = 0;
        for (key in listAdded) {
            var total = listAdded[key].count * listAdded[key].price;
            htmlContent += '<tr>';
            htmlContent += '   <td width="100px" height="100px" class="package-img-cart">';
            htmlContent += '       <img width="100%" height="100%" src=\'' + listAdded[key].thumbnail + '\' alt="">';
            htmlContent += '   </td>';
            htmlContent += '   <td class="text-center package-name-cart">' + listAdded[key].name + '</td>';
            htmlContent += '   <td class="text-center package-price-cart">' + listAdded[key].price + '</td>';
            htmlContent += '   <td class="text-center">';
            htmlContent += '    <a class="mr-2 cart-add" style="text-decoration: none" href>+</a>';
            htmlContent += '   <span class="d-none package-id-cart">' + listAdded[key].id + '</span>'
            htmlContent += '    <input class="text-center package-quantity-cart" id="quantity" readonly autocomplete="off" type="text" size="1" name="count" value="' + listAdded[key].count + '">';
            htmlContent += '    <a class="ml-2 cart-minus" style="text-decoration: none" href="">-</a>';
            htmlContent += '   </td>';
            htmlContent += '   <td class="text-center ">' + total + ' VND</td>';
            htmlContent += '   <td class="text-center "><a href="" class="del-cart"><i class="fas fa-trash-alt"></i></a></td>';
            htmlContent += '</tr>';
            all = all + total

        }
        htmlContent += '<td colspan="3">Mã giảm giá/ Quà tặng:</td>';
        htmlContent += ' <td colspan="3" class="text-center font-weight-bold"> Tổng tiền: ' + all + ' VND</td>';
        $('#list-cart').html(htmlContent);
    } else {
        alert('Chưa thêm gói tập nào!');
    }
    $('#btn-pay').click(function () {
        var listAddedString = localStorage.getItem('listAdded');
        if (listAddedString != null) {
            var listAdded = JSON.parse(listAddedString);
            $.ajax({
                url: '/cart/complete',
                data: listAdded,
                method: 'POST',
                success: function (data, textStatus, jqXHR) {
                    alert(data);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus);
                }
            });
        }
    });

    $('#btn-pay').prev().click(function () {
        location.reload();
    });

    $('.cart-add').click(function () {
        var id = $(this).next().text();
        var name = $(this).parent().parent().find('.package-name-cart').text();
        var price = $(this).parent().parent().find('.package-price-cart').text();
        var thumbnail = $(this).parent().parent().find('.package-img-cart img').attr("src");
        var count = $(this).next().next().val();
        var package = {
            'id': id,
            'thumbnail': thumbnail,
            'price': price,
            'name': name,
            'count': count
        }
        var listAdded = {};
        if (localStorage.getItem('listAdded') != null) {
            var listAddedString = localStorage.getItem('listAdded');
            listAdded = JSON.parse(listAddedString);
            package.count++;
        }
        listAdded[package.id] = package;
        // đưa map vào local storage.
        localStorage.setItem('listAdded', JSON.stringify(listAdded));
    });
    $('.cart-minus').click(function () {
        var id = $(this).prev().prev().text();
        var name = $(this).parent().parent().find('.package-name-cart').text();
        var price = $(this).parent().parent().find('.package-price-cart').text();
        var thumbnail = $(this).parent().parent().find('.package-img-cart img').attr("src");
        var count = $(this).prev().val();
        var package = {
            'id': id,
            'thumbnail': thumbnail,
            'price': price,
            'name': name,
            'count': count
        }
        var listAdded = {};
        if (localStorage.getItem('listAdded') != null) {
            var listAddedString = localStorage.getItem('listAdded');
            listAdded = JSON.parse(listAddedString);
            if (count > 1) {
                package.count--;
            }
        }
        listAdded[package.id] = package;
        localStorage.setItem('listAdded', JSON.stringify(listAdded));
    });
    $('.del-cart').click(function () {
        var id = $(this).parent().prev().prev().find('.package-id-cart').text();
        var name = $(this).parent().parent().find('.package-name-cart').text();
        var price = $(this).parent().parent().find('.package-price-cart').text();
        var thumbnail = $(this).parent().parent().find('.package-img-cart img').attr("src");
        var count = $(this).parent().prev().prev().find('.package-quantity-cart').val();
        var package = {
            'id': id,
            'thumbnail': thumbnail,
            'price': price,
            'name': name,
            'count': count
        }
        var listAdded = {};
        if (localStorage.getItem('listAdded') != null) {
            var listAddedString = localStorage.getItem('listAdded');
            listAdded = JSON.parse(listAddedString);
            delete listAdded[package.id];
        }

        localStorage.setItem('listAdded', JSON.stringify(listAdded));
    });
</script>
</body>
</html>